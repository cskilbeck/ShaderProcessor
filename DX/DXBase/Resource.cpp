//////////////////////////////////////////////////////////////////////

#include "DXBase.h"

//////////////////////////////////////////////////////////////////////

namespace DX
{
	Resource::Resource()
		: data(null)
		, size(0)
	{
	}

	//////////////////////////////////////////////////////////////////////

	Resource::~Resource()
	{
	}

	//////////////////////////////////////////////////////////////////////

	WinResource::WinResource(DWORD resourceid)
		: Resource()
	{
		DXT(LoadResource(resourceid, &data, &size));
	}

	//////////////////////////////////////////////////////////////////////

	WinResource::~WinResource()
	{
		if(data != null)
		{
			FreeResource(data);
			data = null;
		}
		size = 0;
	}

	//////////////////////////////////////////////////////////////////////
	// TODO (charlie): get rid of this crap

	//////////////////////////////////////////////////////////////////////

	FileResource::FileResource()
	{
		Data() = null;
		Size() = 0;
	}

	//////////////////////////////////////////////////////////////////////

	FileResource::FileResource(tchar const *filename)
		: Resource()
	{
		MemoryFile f;
		if(!LoadFile(filename, f))
		{
			throw("Error loading file");
		}
		DXT(f.GetSize(size));
		data = f.ptr;
		f.own = false;
	}

	//////////////////////////////////////////////////////////////////////

	FileResource::FileResource(void *p, uint64 s)
	{
		Data() = p;
		Size() = s;
	}

	//////////////////////////////////////////////////////////////////////

	FileResource::~FileResource()
	{
		Delete(data);
		size = 0;
	}

	void FileResource::Set(void *pdata, uint64 usize)
	{
		data = pdata;
		size = usize;
	}
}
